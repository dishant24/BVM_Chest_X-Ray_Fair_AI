Loading images: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2951/2951 [00:02<00:00, 1066.14it/s, Loaded=2951]
C:\Users\sutariya\Desktop\Thesis\CXR_Preprocessing\cxr_preprocessing\chexpert_model.py:142: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  training_data_merge['race_encoded'] = label_encoder.fit_transform(training_data_merge['race'])
Loading images: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 980/980 [00:00<00:00, 1055.18it/s, Loaded=980]
C:\Users\sutariya\Desktop\Thesis\CXR_Preprocessing\cxr_preprocessing\chexpert_model.py:142: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  training_data_merge['race_encoded'] = label_encoder.fit_transform(training_data_merge['race'])
(array([0, 1, 2, 3, 4]), array([ 346,  147,  418,  351, 1689]))
(array([0, 1, 2, 3, 4]), array([118,  54, 120, 103, 585]))
Traceback (most recent call last):                                                                                                                                                                                                     
Epoch [1/20.0000], Train AUC: 0.5018, Train Acc: 0.1062, Train Loss: 1.6154, Val AUC: 0.5170, Val Acc: 0.1134, Val Loss: 1.6128
Epoch [2/20.0000], Train AUC: 0.5153, Train Acc: 0.1340, Train Loss: 1.6115, Val AUC: 0.5196, Val Acc: 0.1502, Val Loss: 1.6131
Epoch [3/20.0000], Train AUC: 0.5247, Train Acc: 0.1453, Train Loss: 1.6034, Val AUC: 0.5270, Val Acc: 0.1791, Val Loss: 1.6088
Epoch [4/20.0000], Train AUC: 0.5452, Train Acc: 0.2051, Train Loss: 1.5997, Val AUC: 0.5274, Val Acc: 0.2244, Val Loss: 1.6083
Epoch [5/20.0000], Train AUC: 0.5433, Train Acc: 0.2383, Train Loss: 1.5985, Val AUC: 0.5317, Val Acc: 0.2501, Val Loss: 1.6086
Epoch [6/20.0000], Train AUC: 0.5500, Train Acc: 0.2606, Train Loss: 1.5955, Val AUC: 0.5285, Val Acc: 0.2516, Val Loss: 1.6086
Epoch [7/20.0000], Train AUC: 0.5551, Train Acc: 0.2694, Train Loss: 1.5952, Val AUC: 0.5349, Val Acc: 0.2349, Val Loss: 1.6077
Epoch [8/20.0000], Train AUC: 0.5557, Train Acc: 0.2554, Train Loss: 1.5917, Val AUC: 0.5295, Val Acc: 0.2266, Val Loss: 1.6078
Epoch [9/20.0000], Train AUC: 0.5592, Train Acc: 0.2674, Train Loss: 1.5889, Val AUC: 0.5336, Val Acc: 0.2058, Val Loss: 1.6054
Epoch [10/20.0000], Train AUC: 0.5590, Train Acc: 0.2466, Train Loss: 1.5900, Val AUC: 0.5319, Val Acc: 0.2192, Val Loss: 1.6051
  File "C:\Users\sutariya\Desktop\Thesis\CXR_Preprocessing\cxr_preprocessing\chexpert_model.py", line 538, in <module>
    model_training(model, train_loader, val_loader, criterion,  20, device=device, multi_label=False)
  File "C:\Users\sutariya\Desktop\Thesis\CXR_Preprocessing\cxr_preprocessing\chexpert_model.py", line 357, in model_training
    train_loss += loss.item()
                  ^^^^^^^^^^^
KeyboardInterrupt
