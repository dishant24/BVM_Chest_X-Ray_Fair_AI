<>:1: SyntaxWarning: invalid escape sequence '\d'
<>:1: SyntaxWarning: invalid escape sequence '\d'
C:\Users\sutariya\AppData\Local\Temp\ipykernel_14436\1595071097.py:1: SyntaxWarning: invalid escape sequence '\d'
  demographic_data = pd.read_csv('..\\..\datasets\CheXpert-v1.0-small\demographics_CXP.csv')
C:\Users\sutariya\AppData\Local\Temp\ipykernel_14436\2821195456.py:1: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  training_data_merge = training_data_merge.groupby('subject_id', group_keys=False).apply(select_most_positive_sample).reset_index(drop=True)
torch.Size([32, 3, 64, 64]) torch.Size([32])
100%|██████████| 402/402 [01:26<00:00,  4.63it/s, acc=0.861]                                       
Epoch [1/10],Train Loss: 0.3084, Train Acc: 0.8626, Val Loss: 0.3158, Val Acc: 0.8652
Epoch [2/10],Train Loss: 0.2998, Train Acc: 0.8655, Val Loss: 0.3180, Val Acc: 0.8580
Epoch [3/10],Train Loss: 0.2889, Train Acc: 0.8686, Val Loss: 0.3125, Val Acc: 0.8660
Epoch [4/10],Train Loss: 0.2781, Train Acc: 0.8736, Val Loss: 0.3238, Val Acc: 0.8679
Epoch [5/10],Train Loss: 0.2641, Train Acc: 0.8798, Val Loss: 0.3334, Val Acc: 0.8654
Epoch [6/10],Train Loss: 0.2409, Train Acc: 0.8910, Val Loss: 0.3516, Val Acc: 0.8573
Epoch [7/10],Train Loss: 0.2064, Train Acc: 0.9071, Val Loss: 0.4326, Val Acc: 0.8426
Epoch [8/10],Train Loss: 0.1710, Train Acc: 0.9243, Val Loss: 0.4842, Val Acc: 0.8417
Epoch [9/10],Train Loss: 0.1400, Train Acc: 0.9405, Val Loss: 0.5304, Val Acc: 0.8563
Epoch [10/10],Train Loss: 0.1136, Train Acc: 0.9521, Val Loss: 0.5837, Val Acc: 0.8209
Final Train AUC-ROC: 0.7130
Final Validation AUC-ROC: 0.6127
odict_keys(['encoder.features.conv0.weight', 'encoder.features.norm0.weight', 'encoder.features.norm0.bias', 'encoder.features.norm0.running_mean', 'encoder.features.norm0.running_var', 'encoder.features.norm0.num_batches_tracked', 'encoder.features.denseblock1.denselayer1.norm1.weight', 'encoder.features.denseblock1.denselayer1.norm1.bias', 'encoder.features.denseblock1.denselayer1.norm1.running_mean', 'encoder.features.denseblock1.denselayer1.norm1.running_var', 'encoder.features.denseblock1.denselayer1.norm1.num_batches_tracked', 'encoder.features.denseblock1.denselayer1.conv1.weight', 'encoder.features.denseblock1.denselayer1.norm2.weight', 'encoder.features.denseblock1.denselayer1.norm2.bias', 'encoder.features.denseblock1.denselayer1.norm2.running_mean', 'encoder.features.denseblock1.denselayer1.norm2.running_var', 'encoder.features.denseblock1.denselayer1.norm2.num_batches_tracked', 'encoder.features.denseblock1.denselayer1.conv2.weight', 'encoder.features.denseblock1.denselayer2.norm1.weight', 'encoder.features.denseblock1.denselayer2.norm1.bias', 'encoder.features.denseblock1.denselayer2.norm1.running_mean', 'encoder.features.denseblock1.denselayer2.norm1.running_var', 'encoder.features.denseblock1.denselayer2.norm1.num_batches_tracked', 'encoder.features.denseblock1.denselayer2.conv1.weight', 'encoder.features.denseblock1.denselayer2.norm2.weight', 'encoder.features.denseblock1.denselayer2.norm2.bias', 'encoder.features.denseblock1.denselayer2.norm2.running_mean', 'encoder.features.denseblock1.denselayer2.norm2.running_var', 'encoder.features.denseblock1.denselayer2.norm2.num_batches_tracked', 'encoder.features.denseblock1.denselayer2.conv2.weight', 'encoder.features.denseblock1.denselayer3.norm1.weight', 'encoder.features.denseblock1.denselayer3.norm1.bias', 'encoder.features.denseblock1.denselayer3.norm1.running_mean', 'encoder.features.denseblock1.denselayer3.norm1.running_var', 'encoder.features.denseblock1.denselayer3.norm1.num_batches_tracked', 'encoder.features.denseblock1.denselayer3.conv1.weight', 'encoder.features.denseblock1.denselayer3.norm2.weight', 'encoder.features.denseblock1.denselayer3.norm2.bias', 'encoder.features.denseblock1.denselayer3.norm2.running_mean', 'encoder.features.denseblock1.denselayer3.norm2.running_var', 'encoder.features.denseblock1.denselayer3.norm2.num_batches_tracked', 'encoder.features.denseblock1.denselayer3.conv2.weight', 'encoder.features.denseblock1.denselayer4.norm1.weight', 'encoder.features.denseblock1.denselayer4.norm1.bias', 'encoder.features.denseblock1.denselayer4.norm1.running_mean', 'encoder.features.denseblock1.denselayer4.norm1.running_var', 'encoder.features.denseblock1.denselayer4.norm1.num_batches_tracked', 'encoder.features.denseblock1.denselayer4.conv1.weight', 'encoder.features.denseblock1.denselayer4.norm2.weight', 'encoder.features.denseblock1.denselayer4.norm2.bias', 'encoder.features.denseblock1.denselayer4.norm2.running_mean', 'encoder.features.denseblock1.denselayer4.norm2.running_var', 'encoder.features.denseblock1.denselayer4.norm2.num_batches_tracked', 'encoder.features.denseblock1.denselayer4.conv2.weight', 'encoder.features.denseblock1.denselayer5.norm1.weight', 'encoder.features.denseblock1.denselayer5.norm1.bias', 'encoder.features.denseblock1.denselayer5.norm1.running_mean', 'encoder.features.denseblock1.denselayer5.norm1.running_var', 'encoder.features.denseblock1.denselayer5.norm1.num_batches_tracked', 'encoder.features.denseblock1.denselayer5.conv1.weight', 'encoder.features.denseblock1.denselayer5.norm2.weight', 'encoder.features.denseblock1.denselayer5.norm2.bias', 'encoder.features.denseblock1.denselayer5.norm2.running_mean', 'encoder.features.denseblock1.denselayer5.norm2.running_var', 'encoder.features.denseblock1.denselayer5.norm2.num_batches_tracked', 'encoder.features.denseblock1.denselayer5.conv2.weight', 'encoder.features.denseblock1.denselayer6.norm1.weight', 'encoder.features.denseblock1.denselayer6.norm1.bias', 'encoder.features.denseblock1.denselayer6.norm1.running_mean', 'encoder.features.denseblock1.denselayer6.norm1.r
odict_keys(['encoder.features.conv0.weight', 'encoder.features.norm0.weight', 'encoder.features.norm0.bias', 'encoder.features.norm0.running_mean', 'encoder.features.norm0.running_var', 'encoder.features.norm0.num_batches_tracked', 'encoder.features.denseblock1.denselayer1.norm1.weight', 'encoder.features.denseblock1.denselayer1.norm1.bias', 'encoder.features.denseblock1.denselayer1.norm1.running_mean', 'encoder.features.denseblock1.denselayer1.norm1.running_var', 'encoder.features.denseblock1.denselayer1.norm1.num_batches_tracked', 'encoder.features.denseblock1.denselayer1.conv1.weight', 'encoder.features.denseblock1.denselayer1.norm2.weight', 'encoder.features.denseblock1.denselayer1.norm2.bias', 'encoder.features.denseblock1.denselayer1.norm2.running_mean', 'encoder.features.denseblock1.denselayer1.norm2.running_var', 'encoder.features.denseblock1.denselayer1.norm2.num_batches_tracked', 'encoder.features.denseblock1.denselayer1.conv2.weight', 'encoder.features.denseblock1.denselayer2.norm1.weight', 'encoder.features.denseblock1.denselayer2.norm1.bias', 'encoder.features.denseblock1.denselayer2.norm1.running_mean', 'encoder.features.denseblock1.denselayer2.norm1.running_var', 'encoder.features.denseblock1.denselayer2.norm1.num_batches_tracked', 'encoder.features.denseblock1.denselayer2.conv1.weight', 'encoder.features.denseblock1.denselayer2.norm2.weight', 'encoder.features.denseblock1.denselayer2.norm2.bias', 'encoder.features.denseblock1.denselayer2.norm2.running_mean', 'encoder.features.denseblock1.denselayer2.norm2.running_var', 'encoder.features.denseblock1.denselayer2.norm2.num_batches_tracked', 'encoder.features.denseblock1.denselayer2.conv2.weight', 'encoder.features.denseblock1.denselayer3.norm1.weight', 'encoder.features.denseblock1.denselayer3.norm1.bias', 'encoder.features.denseblock1.denselayer3.norm1.running_mean', 'encoder.features.denseblock1.denselayer3.norm1.running_var', 'encoder.features.denseblock1.denselayer3.norm1.num_batches_tracked', 'encoder.features.denseblock1.denselayer3.conv1.weight', 'encoder.features.denseblock1.denselayer3.norm2.weight', 'encoder.features.denseblock1.denselayer3.norm2.bias', 'encoder.features.denseblock1.denselayer3.norm2.running_mean', 'encoder.features.denseblock1.denselayer3.norm2.running_var', 'encoder.features.denseblock1.denselayer3.norm2.num_batches_tracked', 'encoder.features.denseblock1.denselayer3.conv2.weight', 'encoder.features.denseblock1.denselayer4.norm1.weight', 'encoder.features.denseblock1.denselayer4.norm1.bias', 'encoder.features.denseblock1.denselayer4.norm1.running_mean', 'encoder.features.denseblock1.denselayer4.norm1.running_var', 'encoder.features.denseblock1.denselayer4.norm1.num_batches_tracked', 'encoder.features.denseblock1.denselayer4.conv1.weight', 'encoder.features.denseblock1.denselayer4.norm2.weight', 'encoder.features.denseblock1.denselayer4.norm2.bias', 'encoder.features.denseblock1.denselayer4.norm2.running_mean', 'encoder.features.denseblock1.denselayer4.norm2.running_var', 'encoder.features.denseblock1.denselayer4.norm2.num_batches_tracked', 'encoder.features.denseblock1.denselayer4.conv2.weight', 'encoder.features.denseblock1.denselayer5.norm1.weight', 'encoder.features.denseblock1.denselayer5.norm1.bias', 'encoder.features.denseblock1.denselayer5.norm1.running_mean', 'encoder.features.denseblock1.denselayer5.norm1.running_var', 'encoder.features.denseblock1.denselayer5.norm1.num_batches_tracked', 'encoder.features.denseblock1.denselayer5.conv1.weight', 'encoder.features.denseblock1.denselayer5.norm2.weight', 'encoder.features.denseblock1.denselayer5.norm2.bias', 'encoder.features.denseblock1.denselayer5.norm2.running_mean', 'encoder.features.denseblock1.denselayer5.norm2.running_var', 'encoder.features.denseblock1.denselayer5.norm2.num_batches_tracked', 'encoder.features.denseblock1.denselayer5.conv2.weight', 'encoder.features.denseblock1.denselayer6.norm1.weight', 'encoder.features.denseblock1.denselayer6.norm1.bias', 'encoder.features.denseblock1.denselayer6.norm1.running_mean', 'encoder.features.denseblock1.denselayer6.norm1.r
Final Test Accuracy: 0.8607
Final Test AUC-ROC: 0.5000
