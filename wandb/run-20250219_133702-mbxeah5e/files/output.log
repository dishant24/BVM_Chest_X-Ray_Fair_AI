Loading images: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4928/4928 [00:04<00:00, 1070.39it/s, Loaded=4928]
C:\Users\sutariya\Desktop\Thesis\CXR_Preprocessing\cxr_preprocessing\chexpert_model.py:143: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  training_data_merge['race_encoded'] = label_encoder.fit_transform(training_data_merge['race'])
Loading images: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 980/980 [00:00<00:00, 1066.53it/s, Loaded=980]
C:\Users\sutariya\Desktop\Thesis\CXR_Preprocessing\cxr_preprocessing\chexpert_model.py:143: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  training_data_merge['race_encoded'] = label_encoder.fit_transform(training_data_merge['race'])
(array([0, 1, 2, 3, 4]), array([ 566,  235,  706,  579, 2842]))
(array([0, 1, 2, 3, 4]), array([118,  54, 120, 103, 585]))
Traceback (most recent call last):                                                                                                                                                                                                     
Epoch [1/20.0000], Train AUC: 0.4697, Train Acc: 0.1482, Train Loss: 1.6283, Val AUC: 0.4963, Val Acc: 0.2046, Val Loss: 1.6159
Epoch [2/20.0000], Train AUC: 0.4928, Train Acc: 0.1902, Train Loss: 1.6160, Val AUC: 0.5149, Val Acc: 0.2277, Val Loss: 1.6101
Epoch [3/20.0000], Train AUC: 0.5222, Train Acc: 0.2029, Train Loss: 1.6072, Val AUC: 0.4995, Val Acc: 0.1918, Val Loss: 1.6131
Epoch [4/20.0000], Train AUC: 0.5330, Train Acc: 0.2032, Train Loss: 1.6043, Val AUC: 0.5349, Val Acc: 0.2032, Val Loss: 1.6071
Epoch [5/20.0000], Train AUC: 0.5597, Train Acc: 0.2249, Train Loss: 1.5989, Val AUC: 0.5271, Val Acc: 0.2023, Val Loss: 1.6056
Epoch [6/20.0000], Train AUC: 0.5671, Train Acc: 0.2210, Train Loss: 1.5967, Val AUC: 0.5298, Val Acc: 0.1896, Val Loss: 1.6054
Epoch [7/20.0000], Train AUC: 0.5687, Train Acc: 0.2409, Train Loss: 1.5952, Val AUC: 0.5297, Val Acc: 0.2291, Val Loss: 1.6057
  File "C:\Users\sutariya\Desktop\Thesis\CXR_Preprocessing\cxr_preprocessing\chexpert_model.py", line 566, in <module>
    model_training(model, train_loader, val_loader, criterion,  20, device=device, multi_label=False)
  File "C:\Users\sutariya\Desktop\Thesis\CXR_Preprocessing\cxr_preprocessing\chexpert_model.py", line 378, in model_training
    train_loss += loss.item()
                  ^^^^^^^^^^^
KeyboardInterrupt
